## 非分区表的复制

如果我们想要复制一张非分区表,可以采用如下的语句:

```
create table t_copy as select * from t_temp;
```

这样就复制出一张和t_temp结构一致的表

## 分区表的复制

分区表如果采用`create…as…`的方法去复制,数据是可以查询的,但是表的结构是错误的，它已经变成了一个非分区表。实现分区表的复制，有下面2种方法：

### 动态分区

首先建一张和t_part表结构相同的空表，然后使用**动态分区** 的方法把数据导入。

```
create table t_copy like t_part;
insert overwrite table t_copy partition(year,month)
select id,name,orderdate,substring(orderdate,1,4),substring(orderdate,6,2) from t_part;
```

> 复制时可以修改一些结构，如`create table t_copy like t_part location 'new_path';`
>

### msck修复分区

建一张和t_part表结构相同的空表，然后将t_part表目录下的数据复制到t_copy指定目录下，然后使用分区表的msck指令重新生成分区。

```
create table t_copy like t_part;
dfs -cp /user/hive/warehouse/test_neil.db/t_part/* /user/hive/warehouse/test_neil.db/t_copy/;
msck repair table t_copy;
```

此法速度比动态分区要快，因为复制数据是通过hdfs直接复制，而不用启动mapreduce任务。